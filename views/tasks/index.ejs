<% layout('layouts/boilerplate.ejs') %>
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>すべてのタスク</h1>
        <button
            class="btn btn-success"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#newTaskForm"
            aria-expanded="false"
            aria-controls="newTaskForm"
        >
            新規タスク登録
        </button>
    </div>
    <div class="collapse mb-4" id="newTaskForm">
        <div class="card card-body">
            <h5 class="mb-3">新規タスク</h5>
            <form
                action="/tasks"
                method="post"
                class="needs-validation"
                novalidate
            >
                <div class="mb-3">
                    <label for="title" class="form-label">タイトル</label>
                    <input
                        type="text"
                        id="title"
                        name="task[title]"
                        class="form-control"
                        required
                    />
                    <div class="valid-feedback">OK!</div>
                    <div class="invalid-feedback">
                        タイトルを入力してください
                    </div>
                </div>
                <div class="mb-3">
                    <label for="description" class="form-label">詳細</label>
                    <textarea
                        id="description"
                        name="task[description]"
                        class="form-control"
                        rows="3"
                    ></textarea>
                </div>
                <button type="submit" class="btn btn-primary">登録</button>
            </form>
        </div>
    </div>
    <div class="list-group">
        <% tasks.forEach((task) => { %>
        <a
            href="/tasks/<%= task._id %>"
            class="list-group-item list-group-item-action"
        >
            <div class="d-flex w-100 justify-content-between">
                <h5 class="mb-1"><%= task.title %></h5>
                <small><%= task.status %></small>
            </div>
            <p class="mb-1"><%= task.description %></p>
        </a>
        <% }); %>
    </div>
</div>
